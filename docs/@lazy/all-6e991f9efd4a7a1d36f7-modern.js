(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{29:function(t,e,s){"use strict";s.d(e,"a",(function(){return i}));var n=s(6),o=s(1);function r(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}class i extends n.a{constructor(...t){super(...t),r(this,"state",{isFocused:!1,value:""}),r(this,"onFocus",()=>!this.state.value&&this.setState({isFocused:!0,moveDown:!1})),r(this,"onBlur",()=>!this.state.value&&this.setState({isFocused:!1,moveDown:!0})),r(this,"onInput",t=>this.setState({value:t.target.value})),r(this,"onSubmit",()=>this.props.onSubmit(this.state.value))}render({id:t,buttonText:e="Search",labelText:s="Search For Movies",onInput:n,wssResponse:r},{isFocused:i,moveDown:c}){const u=["_animate",i?"moveup":"",c?"movedown":""];return Object(o.b)("div",{class:"search-component"},Object(o.b)("form",{action:"javascript:",onSubmit:this.onSubmit},Object(o.b)("label",{class:u,for:t},s),Object(o.b)(a,{onFocus:this.onFocus,onBlur:this.onBlur,id:t,onInput:t=>{this.onInput(t),null!=n&&n(t)}}),r,Object(o.b)("button",{class:"search-button"},e)))}}function a({onFocus:t,onBlur:e,onInput:s,id:n}){return Object(o.b)("input",{onFocus:t,onBlur:e,onInput:s,id:n,class:"paper-input"})}},30:function(t,e,s){"use strict";s.d(e,"a",(function(){return u})),s.d(e,"b",(function(){return l}));var n=s(1),o=s(6),r=s(26),i=s(9),a=s(7);function c(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}function u(){return Object(n.b)(n.a,null,Object(n.b)("div",{style:{display:"block",marginTop:"50px"}},"Check some of these movies out!"),Object(n.b)(h))}class h extends o.a{constructor(...t){super(...t),c(this,"state",{resp:[]})}componentWillMount(){i.a.get("/i/rec/").then(t=>t.json()).then(t=>{this.setState({resp:t.recommendations})})}render(t,{resp:e=[]}){return Object(n.b)("div",{class:"rec-box"},e.map(t=>Object(n.b)(l,{data:t})))}}class l extends o.a{render({data:t={},customOnClick:e}){const s=Object(n.b)(n.a,null,Object(n.b)(b,{thumb:t.thumb?Object(a.f)(t.thumb).then(a.i):null}),Object(n.b)("span",{class:"rec-title"},Object(a.c)(t.movie)));return e?Object(n.b)("div",{class:"rec-wrapper",onClick:()=>e(t.id)},s):function(t,e){return t.id?Object(n.b)(r.a,{class:"rec-wrapper",href:Object(a.e)(t.id,t.movie)},e):Object(n.b)("span",{class:"rec-wrapper"},e)}(t,s)}}class b extends o.a{constructor(...t){super(...t),c(this,"state",{thumb:""}),c(this,"componentDidUpdate",this.componentDidMount)}componentDidMount(t){if(null==this.props.thumb)return this.setState(t=>null!=t&&t.thumb?{thumb:""}:null);this.props.thumb&&this.props.thumb.then&&(!this.state.thumb||t&&t.thumb!==this.props.thumb)&&this.props.thumb.then(t=>t&&this.setState({thumb:t}))}render({},{thumb:t=""}){return Object(n.b)("div",{style:{backgroundImage:t?`url(${t})`:"none"},class:"rec-image"})}}},31:function(t,e,s){"use strict";var n=s(2);let o=Object(n.e)();const r=Object(n.b)("Map",o),i=(Object(n.b)("Set",o),Object(n.b)("WeakMap",o)&&Object(n.b)("WeakSet",o),"__@@map"),a=t=>t!=t,c=(t,e)=>t===e||a(t)&&a(e),u=t=>0===t?0:t;let h,l,b;if("undefined"!=typeof Symbol){function p(t,e){const s=t[i];let n=0;const o=s.length,r=e?0:1;return{[Symbol.iterator]:function(){return this},next:function(){return n<o?{value:s[n++][r],done:!1}:{value:void 0,done:!0}}}}h=function(){return this[i][Symbol.iterator]()},l=function(){return p(this,!1)},b=function(){return p(this,!0)}}else h=b=l=function(){console.warn("no symbol support")};var d={keys:b,values:l,entries:h},f=s(10);function m(t,e){const s=t[i],n=s.length;for(let t=0;t<n;t++){const n=s[t];if(c(n[0],e))return n}return null}function g(t,e){if(s=t,!(null!=(n=e)&&"undefined"!=typeof Symbol&&n[Symbol.hasInstance]?n[Symbol.hasInstance](s):s instanceof n))throw new TypeError("Cannot call a class as a function");var s,n}const O=function t(e,s){return g(this,t),!s&&r?new Map(e):(this[i]=[],function(t,e){if(null==e)return;if(!Object(n.d)(e))throw new Error("value:"+String(e)+" is not iterable");const s=e.length;for(let n=0;n<s;n++){const s=e[n];if(!s||2!==s.length)throw new Error("invalid arg");t.set(s[0],s[1])}}(this,e),this)};var v;(v=O).prototype.set=function(t,e){const s=m(this,t);return s?s[1]=e:this[i].push([u(t),e]),this},v.prototype.has=function(t){return!!m(this,t)},v.prototype.delete=function(t){let e=!1;return this[i]=this[i].filter(s=>{const n=!c(s[0],t);return n||(e=!0),n}),e},v.prototype.get=function(t){const e=m(this,t);return e?e[1]:void 0},v.prototype.forEach=function(t,e){const s=this[i],n=s.length;for(let o=0;o<n;o++){const n=s[o],r=n[1],i=n[0],a=this;e?t.call(e,r,i,a):t(r,i,a)}},v.prototype.clear=function(){this[i].length=0},Object.defineProperty(v.prototype,"size",{enumerable:!1,configurable:!0,get:function(){return this[i].length}}),"undefined"!=typeof Symbol&&(v.prototype[Symbol.iterator]=d.entries,v.prototype[Symbol.toStringTag]="Map"),Object(f.a)(v.prototype,d),O[Symbol.species]=O;e.a=O},32:function(t,e,s){"use strict";s.d(e,"b",(function(){return b})),s.d(e,"a",(function(){return p}));var n=s(6),o=s(1),r=s(9),i=s(7),a=s(30);function c(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}const u=new(s(31).a),h=async t=>{const e=await r.a.post("/api/data/search/",!0,Object(i.j)({q:t}));return await e.json()};console.log("Search-results cache:",u);const l=async t=>{t=(t||"").toLowerCase();try{const e=u.get(t);if(e)return console.log("refreshing cache in background"),h(t).then(e=>u.set(t,e)),e;const s=await h(t);return u.set(t,s),s}catch(t){return{hasError:!0}}},b={data:{thumb:""}};class p extends n.a{constructor(...t){super(...t),c(this,"state",{resp:[],fetchingPromise:null,isFetching:!1,showGhost:!0}),c(this,"showResults",t=>t.hasError?this.setState({hasError:!0,resp:[],fetchingPromise:null,isFetching:!1,showGhost:!1}):this.setState({resp:{data:t.movies,q:this.props.q},showGhost:!1,isFetching:!1,fetchingPromise:null}))}componentDidMount(){this.setState({didMount:!0,isFetching:!0,fetchingPromise:l(this.props.q).then(this.showResults),showGhost:!0})}componentDidUpdate(t){(!this.state.isFetching&&this.props.q!==this.state.resp.q||(t||{}).q!==this.props.q)&&this.setState({isFetching:!0,hasError:!1,fetchingPromise:l(this.props.q).then(this.showResults),showGhost:!0})}render({q:t,customOnClick:e},{showGhost:s,resp:n,hasError:r}){return r?Object(o.b)("div",null,"An Error occured"):s?Object(o.b)("div",{class:"rec-box"},Array.from({length:5},()=>Object(o.b)(a.b,b))):n.data&&n.data.length?Object(o.b)("div",{class:"rec-box"},n.data.map(t=>Object(o.b)(a.b,{data:t,customOnClick:e}))):Object(o.b)("div",null,'No Results found for:"',t,'"')}}},33:function(t,e,s){"use strict";var n=s(6),o=s(1),r=s(29),i=s(7),a=s(26);class c{__defaultOnMessage(t){if(["ping","pong"].includes(t.data))return;const e=JSON.parse(t.data);this._socketID=e.socket_id}startConn(t){return this.socket&&[WebSocket.OPEN,WebSocket.CONNECTING].includes(this.socket.readyState)?this.socket:new Promise((e,s)=>{this.socket=new WebSocket(Object(i.h)(t)),this.socket.onopen=()=>{this.socket.onmessage=this.__defaultOnMessage,e(this.socket)},this.socket.onerror=t=>s(t)})}close(){try{this.socket.close()}catch(t){console.warn(t)}}send(t){return this.socket.send(JSON.stringify(t))}sendString(t){return this.socket.send(t)}set onmessage(t){t!==this._onmessage&&(this._onmessage=t,this.socket.onmessage=t=>{const e=JSON.parse(t.data||"{}");return"ping"===e.type||"pong"===e.type?void 0:this._onmessage(e)})}get readyState(){return this.socket.readyState}get isUsable(){return!this.socket||[WebSocket.OPEN,WebSocket.CONNECTING].includes(this.socket.readyState)}get isConnected(){return!!this.socket&&[WebSocket.OPEN,WebSocket.CONNECTING].includes(this.socket.readyState)}}let u;const h=()=>(u||{}).isUsable?u:u=new c;function l(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}let b;class p extends n.a{constructor(...t){super(...t),l(this,"state",{resp:[],prevVal:""}),l(this,"onMessage",t=>{t.data?this.setState({resp:t.data.map(t=>({movie:t.movie,href:Object(i.e)(t.id,t.movie)}))}):this.setState({resp:[]})}),l(this,"componentWillUpdate",this.fetchResponses),l(this,"componentWillMount",this.componentWillUpdate)}async fetchResponses(){const t=this.props.val;t!=this.state.prevVal&&t?(console.log("fetching"),this.setState({prevVal:t}),b=h(),await b.startConn("suggestqueries"),b.onmessage=this.onMessage,b.sendString(t)):this.state.resp.length&&!t&&this.setState({resp:[],prevVal:""})}render(){const t=["response-parent"];return this.state.resp.length&&t.push("has-data"),Object(o.b)("div",{class:t},this.state.resp.map(t=>Object(o.b)(a.a,{class:["movie-link","query-response"],href:t.href},Object(i.c)(t.movie))))}}function d(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}s.d(e,"a",(function(){return f}));class f extends n.a{constructor(...t){super(...t),d(this,"state",{value:""}),d(this,"onInput",t=>{const e=(t.target.value||"").trim();document.title=e?`Search for ${e}`:i.d,this.setState({value:e})}),d(this,"loadSearchResults",()=>{const t=(this.state.value||"").trim();t&&Object(i.g)(t),this.setState({value:""})})}componentWillMount(){h().startConn("suggestqueries")}render(){return Object(o.b)(o.a,null,Object(o.b)(r.a,{id:"landing-search-component",onSubmit:this.loadSearchResults,wssResponse:Object(o.b)(p,{val:this.state.value}),onInput:this.onInput}))}}},38:function(t,e,s){"use strict";s.r(e),s.d(e,"default",(function(){return l}));var n=s(6),o=s(1),r=s(9),i=s(32),a=s(30),c=s(33);let u=[];class h extends n.a{constructor(...t){var e,s,n;super(...t),n={hasResults:!1,showGhost:!0,data:[]},(s="state")in(e=this)?Object.defineProperty(e,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[s]=n}componentDidMount(){if(u.length)return this.setState({resp:u,showGhost:!1});r.a.post("/api/get-all/",!0,{}).then(t=>t.json()).then(t=>{u=t.movies,this.setState({resp:t.movies,showGhost:!1})})}getChildNodes({showGhost:t,resp:e}){return t?Object(o.b)("div",{class:"rec-box"},Array.from({length:5},()=>Object(o.b)(a.b,i.b))):Object(o.b)("div",{class:"rec-box"},e.map(t=>Object(o.b)(a.b,{data:t})))}render({},t){return Object(o.b)("section",{data:"all-results"},this.getChildNodes(t))}}function l(){return Object(o.b)(o.a,null,Object(o.b)(c.a),Object(o.b)(h))}}}]);